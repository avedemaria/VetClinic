# Vet Clinic Android App

## Описание

Прототип Android-приложения для ветеринарной клиники. Приложение позволяет пользователю записываться на приём к врачу, управлять информацией о своих питомцах, а администратору — просматривать и управлять списком приёмов.

Приложение реализовано с соблюдением принципов архитектуры MVVM с разделением на слои `presentation`, `domain`, `data`. Используется современный стек Android-разработки с фокусом на модульность, читаемость и тестируемость кода.

Актуальный код в ветке **develop**.

---

## Функциональные возможности

### Общие:
- Аутентификация и восстановление пароля через **Supabase** (включая поддержку **deep links**)
- Разделение ролей: **администратор** и **пользователь**
- Уведомления через **WorkManager** (за час до приёма)
- Хранение пользовательских данных с помощью **DataStore**
- Частичное покрытие unit-тестами с использованием **JUnit** и **MockK**
- Ограничения доступа к данным реализованы через **RLS (Row-Level Security)** в Supabase
- Смена статуса приёма с помощью **Supabase Realtime (Websocket)** и **Cron**

---

### Пользователь:
- **Главный экран** с BottomNavigationView:
    - Домашняя страница
    - Экран записи к врачу
    - Экран списка приёмов
- **Экран профиля:**
    - Изменение имени и номера телефона
    - Переключение на экран питомцев (ToggleButton)
- **Управление питомцами:**
    - Добавление
    - Удаление (свайп в RecyclerView)
- **Запись к врачу:**
    - Список врачей
    - Детальная информация об услугах врача
    - Экран выбора времени и питомца
    - Диалог подтверждения
    - Перенаправление на экран приёмов
- **Экран приёмов:**
    - Актуальные и архивные приёмы
    - Возможность отменить приём
    - Статус приёма обновляется автоматически на стороне сервера с помощью **Cron** и **Supabase Realtime (WebSocket)**

> *Временные слоты генерируются на клиенте (в демонстрационных целях). В реальных условиях рекомендуется генерировать их на серверной стороне.*

---

### Администратор:
- **Экран приёмов на текущий день**
- Возможность выбрать дату (через DatePickerDialog)
- Пагинация через **Paging 3** + **RemoteMediator**
- Отображение списка приёмов с использованием **RecyclerView**
- Возможность изменения статуса приёма на подтвержденный/неподтвержденный

---

## Технологии

### Архитектура и принципы:
- MVVM
- Clean Architecture (presentation/domain/data)
- Dependency Injection: Dagger2
- Kotlin Coroutines, Flow

### UI и навигация:
- Fragment-based UI
- Navigation Component
- RecyclerView
- BottomNavigationView
- ViewPager2

### Сетевой и локальный доступ:
- API: Retrofit
- Supabase (авторизация, хранение данных, RLS)
- Room (локальная БД)
- Paging 3 + RemoteMediator (для списка приёмов администратора)
- DataStore (для хранения настроек и пользовательских данных)

### Тестирование:
- Unit-тесты: JUnit
- Моки: MockK

## TODO

Проект находится в активной разработке и рефакторинге. В планах:

- Улучшить генерацию временных слотов — перенести логику на сервер.
- Расширить функционал для администраторов (например, управление врачами и услугами).
- Расширить покрытие тестами.
- Внедрить UI-улучшения и анимации для лучшего UX.

---

## Установка и запуск

1. Клонировать репозиторий:
   ```bash
   git clone https://github.com/your-username/vet-clinic-app.git
   ```
2. Создайте файл local.properties в корне проекта:

   ```bash
   SUPABASE_URL=https://your-project.supabase.co
   SUPABASE_ANON_KEY=eyJhbGciOi... #твой ключ
   ```
3. Откройте проект в Android Studio. 

4. Убедитесь, что установлены необходимые зависимости и SDK:

5. Запустите приложение на устройстве или эмуляторе.

---

## Supabase настройки (только для демонстрации)

Для демонстрационного запуска приложения вы можете использовать встроенные значения:

   ```bash
   SUPABASE_URL=https://shuxcjnbzcrpkrtszccr.supabase.co
   SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNodXhjam5iemNycGtydHN6Y2NyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk1NDU0MjgsImV4cCI6MjA1NTEyMTQyOH0.f0c1YOXkqUHm9IoEA7MqoQP3GzI3MZZGcdnTQob3Ju8
   ```
Внимание: Этот ключ предназначен только для демонстрационных целей. Все доступы ограничены RLS-политиками на стороне Supabase. В продакшене следует использовать серверные токены и защищённые механизмы.

Чтобы войти на страницу администратора необходимо ввести следующие логин и пароль: 
**Логин:** admin_test@mail.ru
**Пароль:** 123456

--- 

## Скриншоты

### Главная и профиль пользователя

<p align="center">
  <img src="assets/screenshot_home_page.jpg" width="45%" alt="Главная страница">
  <img src="assets/screenshot_profile.jpg" width="45%" alt="Профиль пользователя">
</p>

### Список врачей и детальная информация

<p align="center">
  <img src="assets/screenshot_doctors.jpg" width="45%" alt="Список врачей">
  <img src="assets/screenshot_doctor_detailed_info.jpg" width="45%" alt="Детальная информация о враче">
</p>

### Запись к врачу и список приёмов

<p align="center">
  <img src="assets/screenshot_book_appointment.jpg" width="45%" alt="Формирование записи">
  <img src="assets/screenshot_appointments.jpg" width="45%" alt="Список приёмов">
</p>

### Питомцы пользователя и экран администратора

<p align="center">
  <img src="assets/screenshot_pets.jpg" width="45%" alt="Питомцы пользователя">
  <img src="assets/screenshot_admin_home.jpg" width="45%" alt="Экран администратора">
</p>

---

## Лицензия

Этот проект распространяется под лицензией MIT.
